import requests
from colorama import Fore, Back, Style
from bs4 import BeautifulSoup
import pyxploitdb

def exploit_finder(service, number):
    exploits = pyxploitdb.searchEDB(str(service),int(number))
    
    num = 1
    for exploit in exploits:
        print(Back.MAGENTA+Style.BRIGHT+Fore.LIGHTWHITE_EX+f'=> Exploit Number: {num} <= '+Style.RESET_ALL+'\n')
        print(Fore.YELLOW+f'Authors: '+Fore.WHITE+ f'{exploit.author} \n')
        print(Fore.YELLOW+f'ID: '+Fore.WHITE+ f'{exploit.id} \n')
        print(Fore.YELLOW+f'Platform: '+ Fore.WHITE+ f'{exploit.platform} \n')
        print(Fore.YELLOW+f'Description: '+ Fore.WHITE+ f'{exploit.description} \n')
        print(Fore.YELLOW+f'Port: '+Fore.WHITE+ f'{exploit.port} \n')
        print(Fore.YELLOW+f'Date Published: '+Fore.WHITE+f'{exploit.date_published} \n')
        print(Fore.YELLOW+f'Tags: '+Fore.WHITE+f'{exploit.tag_if_any} \n')
        print(Fore.YELLOW+f'Type: '+Fore.WHITE+f'{exploit.type} \n')
        print(Fore.YELLOW+f'Version: '+Fore.WHITE+f'{exploit.verified} \n')
        print(Fore.YELLOW+f'URL: '+Fore.CYAN+f'{exploit.link} \n')
        print(Fore.MAGENTA+"-----------------"+Style.RESET_ALL)
        num += 1

def main():
    service = input('Enter Service Name: ')
    number = input('Enter Number of Exploits: ')
    exploit_finder(service, number)
    
if __name__ == '__main__':
    main()